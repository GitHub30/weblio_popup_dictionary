function WeblioExtensions(){function T(W,X){this.x=W;this.y=X}var K;var S;var B;var m=new T(0,0);var h=new T(0,0);var e=new T(0,0);var p=false;var b="";var U="";var F=null;var y=0;var D=false;var M=false;var C="";var O;var u;var G=new T(0,0);var w=new T(0,0);var j=new T(0,0);var c=new RegExp("[ -~]+");var H=new RegExp("[\r\n\t]");var g=Object.prototype.toString;var s=85;var l="sel_mou";var I="sml";var d="hsS";var n="acSh";var J="op";var f=800;var q;if(encodeURIComponent){q=encodeURIComponent(chrome.extension.getURL("options.html"))}else{q=escape(chrome.extension.getURL("options.html"))}var P=chrome.extension.connect();P.postMessage({reld:"init"});P.onMessage.addListener(function(X){if(!X.r_al){return}var W=(X.r_al+"")||"";var Y=W.split(",");l=X.r_act||"sel_mou";d=Y[3]||"hsS";I=Y[2]||"sml";if(I!="sml"){s=210}else{s=85}n=Y[6]||"acSh";J=Y[7]||"op";var Z=Y[4]||800;if(l!="sel"&&l!="sel_ekey"&&l!="sel_mou"){Z=1500}if(C==""||Z!=f){clearInterval(C);C=setInterval(weblioObj.Interval,Z)}f=Z});chrome.extension.onRequest.addListener(function(Y,X,W){P.postMessage({reld:"init"})});this.OnLoadHandler=function(W){P.postMessage({reld:"init"});if(C!=""){clearInterval(C)}C=setInterval(weblioObj.Interval,f);N()};this.KeyUpHandler=function(Z){M=false;if(l!="e_key"&&l!="sel_ekey"){return}if(d=="hsN"&&location.href.indexOf("https://")==0){return}var W="";if(document.all){W=window.event.keyCode}else{W=Z.keyCode}if(W=="17"&&l=="sel_ekey"&&!p&&U.length>0){var X=Z.currentTarget.window;if(!X){X=Z.currentTarget}if((X.getSelection()+"").length>0){return}var Y="//api.weblio.jp/act/quote/v_1_0/e/?q=";if(encodeURIComponent){Y+=encodeURIComponent(U)}else{Y+=escape(U)}Y+="&type="+(I=="lg"?"elarge":"emicro");if(q){Y+="&opul="+q}K=a(K,Y,m,Z);p=true;U="";e.x=h.x;e.y=h.y}else{if(W=="69"&&l=="e_key"&&!p){E(Z)}else{if((W=="17"&&l=="sel_ekey")||(W=="69"&&l=="e_key")){L(Z)}}}};this.KeyDownHandler=function(X){var W="";if(document.all){W=window.event.keyCode}else{W=X.keyCode}if(J=="op"&&M&&W=="87"){P.postMessage({ktp:"op"})}if(W=="18"){M=true}};this.Interval=function(Y){if(U.length==0){P.postMessage({reld:"init"})}if(l!="sel"&&l!="sel_ekey"&&l!="sel_mou"){return}var X=localStorage.weblioObjFlg;if(D){if(X&&X==1){return}if(y>0){if(l!="sel_ekey"){L(Y)}D=false;y=0}if(e.x-h.x>5||e.x-h.x<-120||e.y-h.y>5||e.y-h.y<-50){if(l!="sel_ekey"){L(Y)}D=false}else{++y}}if(l=="sel_ekey"){if(!p&&U.length==0&&b.length>0){U=b;b=""}return}if(U.length>0&&!p){var W="//api.weblio.jp/act/quote/v_1_0/e/?q=";if(encodeURIComponent){W+=encodeURIComponent(U)}else{W+=escape(U)}W+="&type="+(I=="lg"?"elarge":"emicro");if(q){W+="&opul="+q}K=a(K,W,m,Y);p=true;U="";e.x=h.x;e.y=h.y}};this.MouseMoveHandler=function(Z){M=false;if(l=="none"){return}if(d=="hsN"&&location.href.indexOf("https://")==0){return}var W=Z.currentTarget.window;if(!W){W=Z.currentTarget}if(h.x&&h.x==Z.pageX){return}m.x=7+Z.pageX;m.y=7+Z.pageY;h.x=Z.pageX;h.y=Z.pageY;if(u==Z.currentTarget){G.x=7+Z.pageX-Z.screenX;G.y=7+Z.pageY-Z.screenY}if(u==Z.currentTarget.document){w.x=7+Z.pageX;w.y=7+Z.pageY}j.x=Z.screenX;j.y=Z.screenY;B=null;var Y=V(Z);B=Y;var X=W.getSelection()+"";if(X.length==0&&(l=="sel"||l=="sel_ekey"||l=="sel_mou")){r(Z,Y)}else{if(X.length>0&&(l=="sel"||l=="sel_ekey"||l=="sel_mou")&&(g.call(Y.activeElement)==="[object HTMLInputElement]")){r(Z,Y)}}};this.MouseUpHandler=function(X){if(typeof K!="undefined"&&p){var W=R(X);K.style.display="none";K.removeEventListener("onmouseover",v,false);K.removeEventListener("onmouseout",i,false);if(S){S.body.removeChild(K)}else{if(W){W.body.removeChild(K)}}S=null;p=false;b="";F=null}if(F!=null){F=null;return}if((l!="mou"&&l!="sel_mou")||X.button==2){return}if(d=="hsN"&&location.href.indexOf("https://")==0){return}E(X)};function E(aa){var W=aa.currentTarget.window;if(!W){W=aa.currentTarget}var Z=R(aa);if(!p){if(typeof K!="undefined"){K.style.display="none"}var Y=Q(aa,W.getSelection()+"",Z);if(Y.length==0){return}if(g.call(Z.activeElement)==="[object HTMLInputElement]"){return}var X="//api.weblio.jp/act/quote/v_1_0/e/?q=";if(encodeURIComponent){X+=encodeURIComponent(Y)}else{X+=escape(Y)}X+="&type="+(I=="lg"?"elarge":"emicro");if(q){X+="&opul="+q}K=a(K,X,m,aa);p=true;U=""}}function V(X){var W=document;if(X){W=X.currentTarget.document}if(!W){W=X.currentTarget}if(B){W=B}return W}function R(X){var W=document;if(X){W=X.currentTarget.document}if(!W){W=X.currentTarget}if(B){W=B}if(typeof O!="undefined"){if(W.width<322||W.height<s){if(typeof u!="undefined"){W=u;if(G.x>0||G.y>0){m.x=G.x+j.x;m.y=G.y+j.y}else{if(w.x>0||w.y>0){m.x=w.x;m.y=w.y}}}}}return W}function Q(Y,W,X){W=W.replace(H,"");W=W.replace(/^\s+/g,"");if(W.length==0||A(W)||x(W)||W.length>4000){return""}if(l!="mou"&&l!="sel_mou"&&l!="e_key"&&W.length>50){return""}if(F==null){F=X.elementFromPoint(Y.clientX,Y.clientY)}if(F.tagName=="A"||F.parentNode.tagName=="A"){if(n!="acSh"){return""}}return W}function a(aa,W,ab,Z){var Y=R(Z);if(typeof aa!="undefined"&&p){aa.style.display="none";aa.removeEventListener("onmouseover",v,false);aa.removeEventListener("onmouseout",i,false);if(S){S.body.removeChild(aa)}else{if(Y){Y.body.removeChild(aa)}}S=null;aa=null;U=""}aa=document.createElement("div");aa.setAttribute("id","extensionsWeblioEjBx");aa.style.position="absolute";aa.style.zIndex=2147483647;if(ab.x+392>innerWidth){ab.x=innerWidth-400}var X=j.y-35;if(I!="sml"){X=j.y+88}if(innerHeight<X){ab.y-=(s+15)}if(ab.x<0){ab.x=0}if(ab.y<0){ab.y=0}aa.style.left=ab.x+"px";aa.style.top=ab.y+"px";aa.innerHTML='<iframe src="'+W+'" name="weblioExtensionsFrame" width="380" height="'+(s-5)+'" border="0" frameborder="0" scrolling="no"></iframe>';aa.onmouseover=v;aa.onmouseout=i;Y.body.appendChild(aa);S=Y;return aa}function v(){localStorage.weblioObjFlg=1}function i(){localStorage.weblioObjFlg=2}function N(){var W=document.getElementsByTagName("frame");var X=document.getElementsByTagName("iframe");if(W.length>0){k(document)}if(X.length>0){o(document)}}function k(Z){var Y=Z.getElementsByTagName("frame");if(typeof Y=="undefined"||Y.length==0){return}for(var W=0;W<Y.length;W++){if(!Y[W]){continue}var X=Y[W].contentDocument;if(Y[W].contentWindow){X=Y[W].contentWindow.document}if(!X){continue}O=X;if(O.width>=322&&O.height>=s){u=O}X.addEventListener("mousemove",weblioObj.MouseMoveHandler,false);X.addEventListener("mouseup",weblioObj.MouseUpHandler,false);X.addEventListener("keyup",weblioObj.KeyUpHandler,false);X.addEventListener("keydown",weblioObj.KeyDownHandler,false);k(X)}}function o(Z){var Y=Z.getElementsByTagName("iframe");if(typeof Y=="undefined"||Y.length==0){return}if(typeof u=="undefined"){u=document}for(var W=0;W<Y.length;W++){if(!Y[W]){continue}if(!Y[W].contentDocument){continue}var X=Y[W].contentDocument;if(Y[W].contentWindow){X=Y[W].contentWindow.document}if(!X){continue}O=Y[W];X.addEventListener("mousemove",weblioObj.MouseMoveHandler,false);X.addEventListener("mouseup",weblioObj.MouseUpHandler,false);X.addEventListener("keyup",weblioObj.KeyUpHandler,false);X.addEventListener("keydown",weblioObj.KeyDownHandler,false);o(X)}}function A(Z){var X=Z.replace(c,"");for(var W=0;W<X.length;++W){var Y=X.charCodeAt(W);if(Y>1169&&Y<8208){return true}if(Y>12343){return true}}return false}function z(Y){for(var W=0;W<Y.length;++W){var X=Y.charCodeAt(W);if(X<64){return true}if(X>126&&X<191){return true}if(X>511&&X<901){return true}if(X>8208){return true}}return false}function x(W){if(W.indexOf("@")>0){return true}if(W.indexOf("://")>0){return true}return false}function L(X){if(l!="sel"&&l!="sel_ekey"&&l!="sel_mou"&&l!="e_key"){return}var W=R(X);if(typeof K!="undefined"&&p){K.style.display="none";K.removeEventListener("onmouseover",v,false);K.removeEventListener("onmouseout",i,false);if(S){S.body.removeChild(K)}else{if(W){W.body.removeChild(K)}}S=null;p=false}}function t(){if(l!="sel"&&l!="sel_ekey"&&l!="sel_mou"){return}if(typeof K!="undefined"&&p){D=true}b="";U=""}function r(af,ah){if(ah.caretRangeFromPoint){var X="";var ad=ah.caretRangeFromPoint(af.clientX,af.clientY);var aa=ad.startContainer;var ab=aa.textContent;var Y=ad.startOffset;var ag=aa.parentNode;if(ag.tagName=="A"||ag.parentNode.tagName=="A"){if(n!="acSh"){t();return}}if(aa.nodeType==3&&aa.parentNode==ah.elementFromPoint(af.clientX,af.clientY)){if(!ab[Y]||ab[Y].search(/[\s,.:!"]/)!=-1||z(ab[Y])){t();return}if(Y<ab.length){for(var Z=Y;Z>0;--Z){if(ab[Z-1].search(/[\s,.:!"]/)!=-1||z(ab[Z-1])){break}}for(var ae=Y;ae<ab.length-1;++ae){if(ab[ae+1].search(/[\s,.:!"]/)!=-1||z(ab[ae+1])){break}}for(var ac=Z;ac<=ae;++ac){X+=ab[ac]}}if(X.length>0&&(b!=X||l=="sel_ekey")){D=true;var W=Q(af,X,ah);if(W.length==0){return}U=W;b=X;X=""}}else{t()}}}}localStorage.weblioObjFlg=0;var weblioObj=new WeblioExtensions();window.addEventListener("load",weblioObj.OnLoadHandler,true);window.addEventListener("mousemove",weblioObj.MouseMoveHandler,true);window.addEventListener("mouseup",weblioObj.MouseUpHandler,true);window.addEventListener("keyup",weblioObj.KeyUpHandler,true);window.addEventListener("keydown",weblioObj.KeyDownHandler,true);